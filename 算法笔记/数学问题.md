# 素数

素数又称质数，是指除了 1 和本身外，不能被其他树整除的一类数。

**易错：1 既不是素数，也不是合数**

## 素数的判断

若 2 ~ n-1 内存在 n 的约数 k, 则 n/k 也是 n 的一个约数，则 k 与 n/k 必满足一个小于等于 sqrt(n), 一个大于等于 sqrt(n)。

因此，判定 n 能否被 2，3，..., (int)sqrt(n) 整除即可(**易错：包含(int)sqrt(n)**)。

```cpp
for(int i = 2; i*i <=n; i ++){}
```

这种写法 i * i 易导致范围上界溢出，因此建议开根号的写法。

## 素数表

### 暴力法

O(n*sqrt(n)), n 范围小于 10^5

```cpp
bool is_prime(int n){
    for(int i = 2; i <= (int)sqrt(n); i ++){  //（int)sqrt() 边界易错
        if(n % i == 0)
            return false;
    }
    return true;
}

void find_prime(){
    for(int i = 2; i < maxn; i ++){
        if(is_prime(i))
            prime[++ pNum] = i;
    }
}
```

### 筛法

算法从小到大枚举所有数，对每一个素数，筛去它所有倍数，剩下的就是素数。

O(nloglogn), 范围更大，但需要确定大致范围（机试可先测试一遍）

```cpp
void find_prime(){
    for(int i = 2; i < maxn; i ++){
        if(!p[i]){                              // p[i] false 则 i 为素数
            prime[++ pNum] = i;
        }
        for(int j = i + i; j < maxn; j += i){   // j+=i 易错
            p[j] = true;
        }
    }
}
```
